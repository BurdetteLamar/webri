#!/usr/bin/env ruby

# A console application to display Ruby HTML documentation.

require 'optparse'
require_relative '../lib/webri/version'
require_relative '../lib/webri'

options = {}

parser = OptionParser.new

parser.version = WebRI::VERSION
parser.banner = <<-BANNER
webri is a console application for displaying Ruby online HTML documentation.
The HTML documentation is opened in your default web browser.

Usage: #{parser.program_name} [options] name

Argument 'name' specifies the documentation to be displayed;
it may be:

- The name of a class/module such as 'Array' or 'Net::HTTP'.
- The name of a singleton method such as '::parse' or '::new'.
- The name of an instance method such as '#parse' or '#to_s'.
- The name of a Ruby 'file' such as 'ruby:dig_methods'.

If the name does not specify a single documentation page,
webri tries to be helpful by showing related candidate names.

Note that your command window may require you to escape certain characters;
in particular, you may need to escape the pound sign ('#').

For more information, see https://github.com/BurdetteLamar/webri/blob/main/README.md.

BANNER

parser.separator('Options:')
parser.on('-i', '--info', 'Prints information about webri.') do
  options[:info] = true
end
parser.on('-r=RELEASE', '--release=RELEASE', 'Sets the Ruby release to document.') do |value|
  options[:release] = value
end
parser.on('-n', '--noop', 'Does not actually open web page.') do |value|
  options[:noop] = true
end
parser.on('-h', '--help', 'Prints this help.') do
  puts parser
  exit
end
parser.on('-v', '--version', 'Prints the version of webri.') do
  puts WebRI::VERSION
  exit
end

parser.parse!

case ARGV.size
when 0
  name = nil
when 1
  name = ARGV.first
else
  puts "Multiple names given; please do one at at time."
  exit
end

WebRI.new(name, options)
